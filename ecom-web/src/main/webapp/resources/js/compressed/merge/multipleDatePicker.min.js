!function(e){"use strict";var t=function(){return{restrict:"AE",scope:{ngModel:"=?",highlightDays:"=?",dayClick:"=?",dayHover:"=?",month:"=?",monthChanged:"=?",weekDaysOff:"=?",allDaysOff:"=?",daysAllowed:"=?",sundayFirstDay:"=?",disableNavigation:"=?",disallowBackPastMonths:"=?",disallowGoFuturMonths:"=?",showDaysOfSurroundingMonths:"=?",cssDaysOfSurroundingMonths:"=?",fireEventsForDaysOfSurroundingMonths:"=?",disableDaysBefore:"=?",disableDaysAfter:"=?",changeYearPast:"=?",changeYearFuture:"=?"},template:'<div class="multiple-date-picker"><div class="picker-top-row"><div class="text-center picker-navigate picker-navigate-left-arrow" ng-class="{\'disabled\':disableBackButton}" ng-click="previousMonth()">&lt;</div><div class="text-center picker-month">{{monthToDisplay}} <span ng-if="yearsForSelect.length < 2">{{yearToDisplay}}</span><select ng-if="yearsForSelect.length > 1" ng-model="year" ng-change="changeYear(year)" ng-options="y for y in yearsForSelect"></select></div><div class="text-center picker-navigate picker-navigate-right-arrow" ng-class="{\'disabled\':disableNextButton}" ng-click="nextMonth()">&gt;</div></div><div class="picker-days-week-row"><div class="text-center" ng-repeat="day in daysOfWeek">{{day}}</div></div><div class="picker-days-row"><div class="text-center picker-day {{getDayClasses(day)}}" title="{{day.title}}" ng-repeat="day in days" ng-click="toggleDay($event, day)" ng-mouseover="hoverDay($event, day)" ng-mouseleave="dayHover($event, day)">{{day ? day.mdp.otherMonth && !showDaysOfSurroundingMonths ? \'&nbsp;\' : day.date.format(\'D\') : \'\'}}</div></div></div>',link:function(t){t.ngModel=t.ngModel||[];var a=function(){var e=moment(),a=moment(t.month).subtract(1,"month"),n=moment(t.month).add(1,"month");t.disableBackButton=t.disableNavigation||t.disallowBackPastMonths&&e.isAfter(a,"month"),t.disableNextButton=t.disableNavigation||t.disallowGoFuturMonths&&e.isBefore(n,"month")},n=function(){for(var e=moment().localeData()._weekdaysMin,a=[],n=1;7>n;n++)a.push(e[n]);return t.sundayFirstDay?a.splice(0,0,e[0]):a.push(e[0]),a},o=function(){var e=moment().localeData()._months,a=e[t.month.month()];return a.charAt(0).toUpperCase()+a.slice(1)},s=function(){var e=moment(),a=Math.max(0,parseInt(t.changeYearPast,10)||0),n=Math.max(0,parseInt(t.changeYearFuture,10)||0),o=moment(t.month).subtract(a,"year"),s=moment(t.month).add(n,"year"),r=[];s.add(1,"year");for(var i=moment(o);s.isAfter(i,"YEAR");i.add(1,"year"))t.disallowBackPastMonths&&!i.isAfter(e,"year")&&!i.isSame(e,"year")||t.disallowGoFuturMonths&&!i.isBefore(e,"year")&&!i.isSame(e,"year")||r.push(i.format("YYYY"));return r};t.$watch("ngModel",function(){t.generate()},!0),t.$watch("month",function(){t.generate()},!0),t.$watch("highlightDays",function(){t.generate()},!0),t.$watch("weekDaysOff",function(){t.generate()},!0),t.$watch("allDaysOff",function(){t.generate()},!0),t.$watch("daysAllowed",function(){t.generate()},!0),t.$watch(function(){return moment.locale()},function(){t.daysOfWeek=n(),t.monthToDisplay=o()},!0),t.month=t.month||moment().startOf("day"),t.days=[],t.weekDaysOff=t.weekDaysOff||[],t.daysOff=t.daysOff||[],t.disableBackButton=!1,t.disableNextButton=!1,t.daysOfWeek=n(),t.cssDaysOfSurroundingMonths=t.cssDaysOfSurroundingMonths||"picker-empty",t.yearsForSelect=[],t.toggleDay=function(e,a){if(e.preventDefault(),!a.mdp.otherMonth||t.fireEventsForDaysOfSurroundingMonths){var n=!1;e.preventDefault=function(){n=!0},"function"==typeof t.dayClick&&t.dayClick(e,a),a.selectable&&!n&&(a.mdp.selected=!a.mdp.selected,a.mdp.selected?t.ngModel.push(a.date):t.ngModel=t.ngModel.filter(function(e){return!a.date.isSame(e,"day")}))}},t.hoverDay=function(e,a){e.preventDefault();var n=!1;e.preventDefault=function(){n=!0},"function"==typeof t.dayHover&&t.dayHover(e,a),n||(a.mdp.hover="mouseover"===e.type)},t.getDayClasses=function(e){var a="";return!e.css||e.mdp.otherMonth&&!t.showDaysOfSurroundingMonths||(a+=" "+e.css),t.cssDaysOfSurroundingMonths&&e.mdp.otherMonth&&(a+=" "+t.cssDaysOfSurroundingMonths),e.mdp.selected&&(a+=" picker-selected"),e.selectable||(a+=" picker-off"),e.mdp.today&&(a+=" today"),e.mdp.past&&(a+=" past"),e.mdp.future&&(a+=" future"),e.mdp.otherMonth&&(a+=" picker-other-month"),a},t.previousMonth=function(){if(!t.disableBackButton){var e=moment(t.month);t.month=t.month.subtract(1,"month"),"function"==typeof t.monthChanged&&t.monthChanged(t.month,e)}},t.nextMonth=function(){if(!t.disableNextButton){var e=moment(t.month);t.month=t.month.add(1,"month"),"function"==typeof t.monthChanged&&t.monthChanged(t.month,e)}},t.changeYear=function(e){t.month=t.month.year(parseInt(e,10))},t.isDayOff=function(a){return t.allDaysOff||!!t.disableDaysBefore&&moment(a.date).isBefore(t.disableDaysBefore,"day")||!!t.disableDaysAfter&&moment(a.date).isAfter(t.disableDaysAfter,"day")||e.isArray(t.weekDaysOff)&&t.weekDaysOff.some(function(e){return a.date.day()===e})||e.isArray(t.daysOff)&&t.daysOff.some(function(e){return a.date.isSame(e,"day")})||e.isArray(t.daysAllowed)&&!t.daysAllowed.some(function(e){return a.date.isSame(e,"day")})||e.isArray(t.highlightDays)&&t.highlightDays.some(function(e){return a.date.isSame(e.date,"day")&&!e.selectable})},t.isSelected=function(e){return t.ngModel.some(function(t){return e.date.isSame(t,"day")})},t.generate=function(){t.year=t.month.year().toString(),t.yearsForSelect=s(),t.monthToDisplay=o(),t.yearToDisplay=t.month.format("YYYY");var n=moment(t.month).date(0).day(t.sundayFirstDay?0:1).subtract(1,"day");moment(t.month).date(0).diff(n,"day")>6&&(n=n.add(1,"week"));var r=moment(t.month).date(1),i=[],d=moment(),y=moment(r).endOf("month"),l=function(){var a={date:moment(n.add(1,"day")),mdp:{selected:!1}};if(e.isArray(t.highlightDays)){var o=t.highlightDays.filter(function(e){return a.date.isSame(e.date,"day")});a.css=o.length>0?o[0].css:"",a.title=o.length>0?o[0].title:""}return a.selectable=!t.isDayOff(a),a.mdp.selected=t.isSelected(a),a.mdp.today=a.date.isSame(d,"day"),a.mdp.past=a.date.isBefore(d,"day"),a.mdp.future=a.date.isAfter(d,"day"),a.date.isSame(t.month,"month")||(a.mdp.otherMonth=!0),a},c=y.diff(n,"days"),m=t.sundayFirstDay?6:0;y.day()!==m&&(c+=(t.sundayFirstDay?6:7)-y.day());for(var h=0;c>h;h++)i.push(l());t.days=i,a()},t.generate()}}};e.module("multipleDatePicker",[]).directive("multipleDatePicker",t)}(window.angular);